/*! Bubz v1.0.0 | Bill Knechtel | (c) 2026 ThreeBit Media | MIT License */
class BubzIndicator extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this._intervalId=null,this._isVisible=!0,this._observer=null}static get observedAttributes(){return["text","color","size","speed"]}connectedCallback(){this.render(),this.startAnimation(),this.setupVisibilityObserver()}disconnectedCallback(){this.stopAnimation(),this.teardownVisibilityObserver()}setupVisibilityObserver(){this._observer=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&this._isVisible?this.startAnimation():(this.stopAnimation(),this.clearBubbles())})},{threshold:0}),this._observer.observe(this)}teardownVisibilityObserver(){this._observer&&(this._observer.disconnect(),this._observer=null)}attributeChangedCallback(t,e,n){e!==n&&this.shadowRoot.innerHTML&&(this.render(),this.stopAnimation(),this.startAnimation())}get text(){return this.getAttribute("text")||"LOADING"}set text(t){this.setAttribute("text",t)}get color(){return this.getAttribute("color")||"#777"}set color(t){this.setAttribute("color",t)}get size(){return parseFloat(this.getAttribute("size"))||1}set size(t){this.setAttribute("size",t)}get speed(){return parseFloat(this.getAttribute("speed"))||1}set speed(t){this.setAttribute("speed",t)}render(){const t=this.text,e=this.color,n=this.size,i=this.speed,s=this.lightenColor(e,.6),r=70*n,o=20*n,a=t.length*o,l=n<.8?"x-small":n<1.2?"smaller":"small";this.shadowRoot.innerHTML=`\n      <style>\n        :host {\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          width: 100%;\n          height: 100%;\n          opacity: 1;\n          transition: opacity 300ms ease-in-out;\n        }\n\n        :host([hidden]) {\n          opacity: 0;\n          pointer-events: none;\n        }\n\n        .bubz-container {\n          height: ${r}px;\n          min-height: ${r}px;\n          width: ${a}px;\n          margin: 0;\n          padding: 0;\n        }\n\n        .bubz-row {\n          width: ${a}px;\n        }\n\n        .bubble-column {\n          width: ${o}px;\n          display: inline-block;\n          height: ${r}px;\n          margin: 0;\n          padding: 0;\n          position: relative;\n          text-align: center;\n        }\n\n        .loading-text {\n          width: ${o}px;\n          display: inline-block;\n          text-align: center;\n          font-family: Arial, Helvetica, sans-serif;\n          color: ${e};\n          font-size: ${l};\n          animation: gentle-bounce ${2100*i}ms ease-in-out infinite;\n        }\n\n        @keyframes gentle-bounce {\n          0%, 100% {\n            transform: translateY(0);\n          }\n          50% {\n            transform: translateY(-${1.5*n}px);\n          }\n        }\n\n        @keyframes fall-and-fade {\n          0% {\n            transform: translateY(0px) scale(0);\n            opacity: 0;\n          }\n          20% {\n            transform: translateY(${12.6*n}px) scale(1);\n            opacity: 1;\n          }\n          80% {\n            transform: translateY(${50.4*n}px) scale(1);\n            opacity: 1;\n          }\n          100% {\n            transform: translateY(${63*n}px) scale(0);\n            opacity: 0;\n          }\n        }\n\n        .bubble {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          margin: 0 auto;\n          animation: fall-and-fade ${3e3*i}ms linear both;\n        }\n      </style>\n\n      <div class="bubz-container">\n        <div class="bubz-row" data-row="bubbles"></div>\n        <div class="bubz-row" data-row="text"></div>\n      </div>\n    `;const h=this.shadowRoot.querySelector('[data-row="bubbles"]'),d=this.shadowRoot.querySelector('[data-row="text"]');for(let e=0;e<t.length;e++){const n=document.createElement("div");n.classList.add("bubble-column"),n.setAttribute("data-index",e),h.appendChild(n);const s=document.createElement("div");s.innerHTML=t[e],s.classList.add("loading-text"),s.style.animationDelay=300*e*i+"ms",d.appendChild(s)}this._baseColor=e,this._glowColor=s,this._size=n,this._speed=i}startAnimation(){if(this._intervalId)return;const t=this.shadowRoot.querySelectorAll(".bubble-column");t.length&&(this._intervalId=setInterval(()=>{t.forEach((t,e)=>{if(this.randBool()){const n=this.randBool()?7*this._size:4*this._size,i=this.createBubble(n,this._baseColor,this._glowColor);i.style.animationDelay=70*e*this._speed+"ms",i.addEventListener("animationend",()=>i.remove()),t.appendChild(i)}})},630*this._speed))}stopAnimation(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)}createBubble(t,e,n){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("width",t),i.setAttribute("height",t),i.setAttribute("class","bubble"),i.style.filter=`drop-shadow(0 0 ${2*this._size}px ${n})`;const s=document.createElementNS("http://www.w3.org/2000/svg","circle"),r=(t/2).toString();return s.setAttribute("cx",r),s.setAttribute("cy",r),s.setAttribute("r",r),s.setAttribute("fill",e),i.appendChild(s),i}randBool(){return Math.floor(2*Math.random())}lightenColor(t,e){const n=parseInt(t.replace("#",""),16);return`rgb(${Math.min(255,(n>>16)+Math.round(255*e))}, ${Math.min(255,(n>>8&255)+Math.round(255*e))}, ${Math.min(255,(255&n)+Math.round(255*e))})`}show(t){const e=!this._isVisible;return this._isVisible=!0,this.removeAttribute("hidden"),e&&this.startAnimation(),t&&setTimeout(t,300),this}hide(t){const e=this._isVisible;return this._isVisible=!1,this.setAttribute("hidden",""),e&&(this.stopAnimation(),this.clearBubbles()),t&&setTimeout(t,300),this}clearBubbles(){this.shadowRoot.querySelectorAll(".bubble").forEach(t=>t.remove())}isVisible(){return this._isVisible}}customElements.define("bubz-indicator",BubzIndicator);